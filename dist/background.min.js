var currentIcons={},toggleIcon=function(e){var n=e.id;n in currentIcons||resetTabIcon(n),currentIcons[n]=!currentIcons[n],chrome.browserAction.setIcon({path:"img/icon_"+(currentIcons[n]?"active":"inactive")+".png",tabId:n}),chrome.tabs.executeScript({code:"wi.current.toggleStatus()"})},resetTabIcon=function(e){currentIcons[e]=!1};chrome.browserAction.onClicked.addListener(toggleIcon),chrome.tabs.onCreated.addListener(function(e){resetTabIcon(e.id)}),chrome.tabs.onUpdated.addListener(function(e,n,t){resetTabIcon(e)}),chrome.tabs.onRemoved.addListener(function(e,n){currentIcons[e]=null}),chrome.extension.onRequest.addListener(function(e,n){if(e&&"undefined"!=typeof e.action&&n&&"undefined"!=typeof n.tab)switch(e.action){case"toggleIcon":toggleIcon(n.tab)}});